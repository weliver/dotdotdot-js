/*!
 *	dotdotdot JS 4.0.9
 *
 *	dotdotdot.frebsite.nl
 *
 *	Copyright (c) Fred Heusschen
 *	www.frebsite.nl
 *
 *	License: CC-BY-NC-4.0
 *	http://creativecommons.org/licenses/by-nc/4.0/
 */
!function(t){if("object"==typeof module&&"object"==typeof module.exports){var e=t(require,exports);void 0!==e&&(module.exports=e)}else"function"==typeof define&&define.amd&&define(["require","exports"],t)}(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=function(){function t(e,i){void 0===i&&(i=t.options),this.container=e,this.options=i||{},this.watchTimeout=void 0,this.watchInterval=void 0,this.resizeEvent=void 0,this.options=Object.assign({},t.options,this.options);var n=this.container.dotdotdot;n&&n.destroy(),this.API={truncate:this.truncate,restore:this.restore,destroy:this.destroy,watch:this.watch,unwatch:this.unwatch},this.container.dotdotdot=this.API,this.originalStyle=this.container.getAttribute("style")||"",this.originalContent=this._getOriginalContent(),this.ellipsis=this.options.ellipsis?document.createTextNode(this.options.ellipsis):document.createTextNode("");var o=window.getComputedStyle(this.container);"break-word"!==o.wordWrap&&(this.container.style.wordWrap="break-word"),"pre"===o.whiteSpace?this.container.style.whiteSpace="pre-wrap":"nowrap"===o.whiteSpace&&(this.container.style.whiteSpace="normal"),this.options.height=null===this.options.height?this._getMaxHeight():this.options.height,this.maxHeight=this._getMaxHeight(),this.truncate(),this.options.watch&&this.watch()}return t.prototype.restore=function(){var t=this;this.unwatch(),this.container.setAttribute("style",this.originalStyle),this.container.classList.remove("ddd-truncated"),this.container.innerHTML="",this.originalContent.forEach(function(e){t.container.append(e)})},t.prototype.destroy=function(){this.restore(),this.container.dotdotdot=void 0},t.prototype.watch=function(){var t=this;this.unwatch();var e={width:null,height:null},i=function(i,n,o){if(t.container.offsetWidth||t.container.offsetHeight||t.container.getClientRects().length){var r={width:i[n],height:i[o]};return e.width==r.width&&e.height==r.height||t.truncate(),r}return e};"window"==this.options.watch?(this.resizeEvent=function(n){t.watchTimeout&&clearTimeout(t.watchTimeout),t.watchTimeout=setTimeout(function(){e=i(window,"innerWidth","innerHeight")},100)},window.addEventListener("resize",this.resizeEvent)):this.watchInterval=setInterval(function(){e=i(t.container,"clientWidth","clientHeight")},1e3)},t.prototype.unwatch=function(){this.resizeEvent&&(window.removeEventListener("resize",this.resizeEvent),this.resizeEvent=void 0),this.watchInterval&&clearInterval(this.watchInterval),this.watchTimeout&&clearTimeout(this.watchTimeout)},t.prototype.truncate=function(){var t=this,e=!1;return this.container.innerHTML="",this.originalContent.forEach(function(e){t.container.append(e.cloneNode(!0))}),this.maxHeight=this._getMaxHeight(),this._fits()||(e=!0,this._truncateToNode(this.container)),this.container.classList[e?"add":"remove"]("ddd-truncated"),void 0!==this.options.callback&&this.options.callback.call(this.container,e),e},t.prototype._truncateToNode=function(e){var i=[],n=[];if(t.$.contents(e).forEach(function(e){if(!t.isElement(e)||!e.matches(".ddd-keep")){var o=document.createComment("");e.replaceWith(o),n.push(e),i.push(o)}}),n.length){for(var o=0;o<n.length;o++){i[o].replaceWith(n[o]);var r=this.ellipsis.cloneNode(!0),s=n[o];t.isElement(s)?s.append(r):t.isText(s)&&s.after(r);var a=this._fits();if(r.parentElement&&r.parentElement.removeChild(r),!a){if("node"==this.options.truncate&&o>1)return void n[o-2].remove();break}}for(var h=o;h<i.length;h++)i[h].remove();var c=n[Math.max(0,Math.min(o,n.length-1))];if(t.isElement(c)){var d=document.createElement(c.nodeName);d.append(this.ellipsis),c.replaceWith(d),this._fits()?d.replaceWith(c):(d.remove(),c=n[Math.max(0,o-1)])}1==c.nodeType?this._truncateToNode(c):this._truncateToWord(c)}},t.prototype._truncateToWord=function(t){for(var e=t.textContent,i=e?-1!==e.indexOf(" ")?" ":"　":" ",n=e?e.split(i):[],o=n.length;o>=0;o--)if(t.textContent=this._addEllipsis(n.slice(0,o).join(i)),this._fits()){"letter"==this.options.truncate&&(t.textContent=n.slice(0,o+1).join(i),this._truncateToLetter(t));break}},t.prototype._truncateToLetter=function(t){for(var e=t.textContent?t.textContent.split(""):[],i="",n=e.length;n>=0&&(!(i=e.slice(0,n).join("")).length||(t.textContent=this._addEllipsis(i),!this._fits()));n--);},t.prototype._fits=function(){return this.container.scrollHeight<=this.maxHeight+(this.options.tolerance||0)},t.prototype._addEllipsis=function(t){for(var e=[" ","　",",",";",".","!","?"];e.indexOf(t.slice(-1))>-1;)t=t.slice(0,-1);return t+=this.ellipsis.textContent},t.prototype._getOriginalContent=function(){var e="script, style";this.options.keep&&(e+=", "+this.options.keep),t.$.find(e,this.container).forEach(function(t){t.classList.add("ddd-keep")}),[this.container].concat(t.$.find("*",this.container)).forEach(function(e){e.normalize(),t.$.contents(e).forEach(function(i){var n=!1;if(t.isText(i)){if(""==(i.textContent||"").trim()){var o=i.previousSibling,r=i.nextSibling;(i.parentElement&&i.parentElement.matches("table, thead, tbody, tfoot, tr, dl, ul, ol, video")||!o||o.matches("div, p, table, td, td, dt, dd, li")||!r||r.matches("div, p, table, td, td, dt, dd, li"))&&(n=!0)}}else t.isText(i)&&(n=!0);n&&e.removeChild(i)})});var i=[];return t.$.contents(this.container).forEach(function(t){i.push(t.cloneNode(!0))}),i},t.prototype._getMaxHeight=function(){if("number"==typeof this.options.height)return this.options.height;for(var t=window.getComputedStyle(this.container),e=["maxHeight","height"],i=0,n=0;n<e.length;n++){if("px"==(o=t[e[n]]).slice(-2)){i=parseFloat(o);break}}switch(e=[],t.boxSizing){case"border-box":e.push("borderTopWidth"),e.push("borderBottomWidth");case"padding-box":e.push("paddingTop"),e.push("paddingBottom")}for(n=0;n<e.length;n++){var o;"px"==(o=t[e[n]]).slice(-2)&&(i-=parseFloat(o))}return Math.max(i,0)},t.isElement=function(t){return 1===t.nodeType},t.isText=function(t){return 3===t.nodeType},t.isComment=function(t){return 8===t.nodeType},t.version="4.0.9",t.options={ellipsis:"… ",callback:function(){},truncate:"word",tolerance:0,keep:void 0,watch:"window",height:void 0},t.$={find:function(t,e){return e=e||document,Array.prototype.slice.call(e.querySelectorAll(t))},contents:function(t){return t=t||document,[].slice.call(t.childNodes)}},t}();e.default=n,void 0!==(i=window.Zepto||window.jQuery)&&(i.fn.dotdotdot=function(t){return this.each(function(e,i){var o=new n(i,t);i.dotdotdot=o.API})})});